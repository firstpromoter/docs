This is the `fpr.js` reference document for all the methods or functions available in FirstPromoter's browser-side JavaScript Library.

## Including fpr.js on your website or web aplication
<Tabs>
  <Tab title="FirstPromoter v1 users">
    On your FirstPromoter dashboard, kindly go to the `Getting started > Quick setup` section, follow the instructions/steps and you will be provided with some scripts which are to be added to your website. The scripts should look like the `Example: main tracking script` below.
  </Tab>
  <Tab title="FirstPromoter v2 users">
   On your FirstPromoter dashboard, kindly go to `Settings > integrations > Integrate your website` and click on the `integrate` button. Follow the instructions or guide to get scripts which are to be added to your website. The scripts should look like the `Example: Main tracking script` below.
  </Tab>
</Tabs>

<Tip>
 It is ideal that the script is added globally on the HEAD section of every marketing or public page of your website.
</Tip>

```javascript Example: Main tracking script
<script>
(function(w){w.fpr=w.fpr||function(){w.fpr.q = w.fpr.q||[];w.fpr.q[arguments[0]=='set'?'unshift':'push'](arguments);};})(window);
fpr("init", {cid:"xxxxxxxx"}); 
fpr("click");
</script>
<script src="https://cdn.firstpromoter.com/fpr.js" async></script>
```

**For JavaScript frameworks**, you can simply insert the script on the public `index.html` page so it will be available when the framework loads.

**For WordPress websites**, you can add the scripts to your `header.php` file before the closing head tag.

<Tip>
To get the best performance, it is ideal that you have the scripts added to all the pages where you need tracking to take place. Also, the Scripts are loaded asynchronously and will not affect the website loading speed.
</Tip>
     

## fpr methods and usage examples:
Below are the fpr methods or functions available in the `fpr.js` javascript ibrary:

### fpr("init",options, callback?)
This method helps initializes first promoter with the provided options. Most of these options are loaded automatically when the script loads, but they can be overwritten by passing different ones to the method. The most used one is `ref_id` which forces the script to track a specific promoter.

```script 
Method parameters

 options (object)
  Accepted keys
    cid: company ID 
    ref_id: referral id/token of the promoter
    tid: tracking ID, value stored in fprom_tid cookie
    url: current URL
    domain: current domain
    referrer: browser referrer/ domain of the previous visited website
 callback (function) NOT REQUIRED
```   

### fpr("click",payload?, callback?)
This method is responsible for unique click tracking. 

```script 
Method parameters
payload (object)  NOT REQUIRED
This overwrites the stored data exactly like the fpr("init"â€¦) function does before tracking the click.  

callback (function) NOT REQUIRED

The callback function receives the response data object and can then be extracted and use
```
#### Method usage
<CodeGroup>
```javascript Example: click tracking
fpr("click");
```
```javascript  Example: click tracking with ref_id
/* 
Passing 'xxx' ensure that vistor's tracking id (tid) 
also known as '_fprom_tid' cookie is regenerated  
*/
fpr("click", {ref_id: 'xxx'});
```
</CodeGroup>


### fpr("onReady",callback)
This method checks if the tracking script is initialized and fully loaded on the page 


#### Method parameters

<ParamField query="callback" type="function" required>
 The callback function receives the response `data` object from FirstPromoter
 ```json structure of response 'data' returned
{
  domain : "",
  test_mode : false,
  cookie_tid: "",
  cookie_ref_id: "",
  referrer: "",
  url_ref_id: null,
  ref_id: "",
  url: "",
  tid: "",
  cr_id: null,
  cid: ""
}
```
</ParamField>


#### Method Usage
```javascript onReady
fpr("onReady", function(data){
  console.log(data)
})
```

### fpr("referral",payload, callback?)
This method is used primarily to send the referral details to first promoter.
It takes as its payload the email of the referral/lead 


#### Method parameters

<ParamField query="payload" type="Object" required>
  It accepts the email of the referral/lead or the uid of the user or both.
  <Expandable title="properties">
    <ParamField query="email" type="string">
      actual email of the user 
    </ParamField>

    <ParamField query="uid" type="string">
       user id of the user
    </ParamField>
  </Expandable>
</ParamField>

<ParamField query="callback" type="function">
  This `callback` function can be used to execute some task after referral is successful. This `callback` parameter is optional.
</ParamField>
 
#### Method usage
<CodeGroup>
```javascript without callback
fpr('referral',{email:"actual_user_email@email.com", uid: "123456"})
```
```javascript with callback
fpr('referral',{email:"actual_user_email@email.com", uid: "123456"}, 
function(){console.log("referral submitted")
})
```
</CodeGroup>


### fpr("details",callback)
This method is used in getting the details of the promotion and the promoter. To avoid making multiple requests, it is important to note that the details are stored in a cookie called `fprom_details` and is available for a day.


#### Method parameters

<ParamField query="callback" type="function" required>
 The callback function receives the response `data` object from FirstPromoter
 ```json structure of response 'data' returned
{
      ref_id: 
      promo_code: 
      campaign_id: 
      customer_promo_code: 
      offer:  
      promoter: {
        id:  
        first_name:  
        last_name:  
      }
}
```
</ParamField>



#### Method usage
```javascript Get Promoter's details and promotions 
fpr("details", function(data){
  console.log(data)
})
```

### fpr("crossDomain",domains)
This method is used when attempting to track across multiple domains. It mainly appends the tracking details to all links to the domain provided.

<Note> This works with only direct links and should be added preferably to the footer section or called when the whole page is loaded </Note>


#### Method parameters

<ParamField query="domains" type="Array|String" required>
  This can be a single or an array or list of your website domains if you have multiple domains.
</ParamField>

#### Method usage

<CodeGroup>
```javascript Single domain
fpr('crossDomain','newwebsite.com')
```
```javascript Multiple domains
fpr('crossDomain',['newwebsite.com', 'newwebsite1.com', 'newwebsite2.com'])
```
</CodeGroup>


<br/>
### fpr("urlTracking")
This method is used for Direct URL tracking, thus, if you have landing pages for your affiliates/promoters, you can use the method on those pages if you don't want the affiliates/promoters "Referral ID" to be part of their referral links.

<Note>
For this method to work, you will have to first add FirstPromoter's main tracking scripts to the landing page(s) and also enable "Direct URL tracking" on First Promoter. To do so, please check out this [article](https://help.firstpromoter.com/en/articles/1978318-how-to-assign-landing-page-urls-to-affiliates-and-avoid-using-links-with-referral-ids-direct-url-tracking).
</Note>

<Warning>
Kindly note that the method can NOT be used on your homepage, but instead should only be used on all landing pages of your affiliates/promoters.
</Warning>

#### Method usage
```javascript Direct URL tracking
<script type="text/javascript">
_fprom=window._fprom||[];window._fprom=_fprom;_fprom.push(["url_tracking",true]);
if (window.$FPROM){ $FPROM.trackVisitor({url_tracking: true})} else if(window.fpr) fpr("urlTracking");
</script>
```